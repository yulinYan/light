webpackJsonp([9],{"6tXJ":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAB80lEQVRYR+2Vv2sVQRDHvzP3IFhbK6kkEJtoKQQkRYI2phMrK8HidldEJAj5gY0QXm7uFenTCa+Ltiq2IY1goZ0WHhb+C97IQk6Wl7t7d+HuJUW2Otjb+X7mO8MM4ZwPnbM+LgFOOeCc0yZlEZFO3Lu4AFUZFg5N3ltrfwP4xMzDJEmOm7jo/6l0oC1AULpcVXezLHs1Ho//TgPpEmBeVe8R0QsA/vtDlmWr0yA6AygyjeN4LoqiBMBTAK9FZLPOhc4BTsTIOfdOVVcGg8G14XD4pwqiLwBYa68T0U8Az0VkrzXAtOapalJjzCNmvp3n+XtmTlX1FzNv5Xm+zszfkiQ5CGP3Mgecc9sAtkIhVX2TpunGZGKdTLMyt0KIKvHSOTDN+jb3HkJV58oyL+LUOnCSBUTEW9rLqQSYqONOXxClAGVNBKAWosUWZQD/N+4pAGPMQyK6BeAQgB+rdwDcB/BAVb+MRqO3FU3XdI3XA4TBrbV7RPRMVRfSNP1e1wRVW7J4E9w3BzDG3GXmjwAOROTxzAG8oHPuK4BFAC9FZDesXwjUiwNewBhzk5mPAFwBcERE+6r6WUR+zATAi8RxvBRFkW++G4Xo5C7ozYEgS79i1wA8AbAsIldn5kCTEdjZHGgiNrM5cFaYNu96W8dNIS4B/gEs9yMwQ0+nBQAAAABJRU5ErkJggg=="},COM7:function(e,t){},H04s:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("koBw"),n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"LightSet"},[a("div",{staticClass:"overview"},[e._m(0),e._v(" "),a("div",{staticClass:"projextSet"},[e.show.area_conf||e.show.conf_area?a("div",{staticClass:"form"},[0!=e.tableData.length?a("div",[a("label",{attrs:{for:""}},[e._v("区域名称：")]),e._v(" "),a("el-select",{attrs:{id:"projectFormName",clearable:"",placeholder:"选择区域名"},on:{change:e.projectFormNameChange},model:{value:e.projectForm.name,callback:function(t){e.$set(e.projectForm,"name",t)},expression:"projectForm.name"}},e._l(e.groupOptions,function(e){return a("el-option",{key:e.shortAddr,attrs:{label:e.shortAddr,value:e.shortAddr}})}),1)],1):e._e(),e._v(" "),0!=e.tableData.length?a("div",[a("label",{attrs:{for:""}},[e._v("备注：")]),e._v(" "),a("el-input",{model:{value:e.projectForm.remarks,callback:function(t){e.$set(e.projectForm,"remarks",t)},expression:"projectForm.remarks"}})],1):e._e(),e._v(" "),a("div",[a("label",{attrs:{for:""}},[e._v("上传地图：")]),e._v(" "),a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.projectForm.fileName,expression:"projectForm.fileName"}],attrs:{type:"text",disabled:"",placeholder:"仅支持JPG、PNG格式，图片小于1M"},domProps:{value:e.projectForm.fileName},on:{input:function(t){t.target.composing||e.$set(e.projectForm,"fileName",t.target.value)}}}),e._v(" "),a("div",{staticClass:"fileBtn"},[e._v("浏览\n              "),a("input",{staticStyle:{width:"100%",height:"100%",opacity:"0",position:"absolute",left:"0",top:"0","z-index":"999"},attrs:{id:"setMap",type:"file",accept:"image/jpg,image/png"},on:{change:function(t){return e.setMap("#setMap")}}})])])])]):e._e(),e._v(" "),e.show.area_conf||e.show.conf_area?a("el-button",{attrs:{type:"primary"},on:{click:e.addArea}},[e._v("添加")]):e._e(),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:"","cell-style":e.cellStyle,"header-cell-style":e.headerStyle,height:e.tableHeight}},[a("el-table-column",{attrs:{prop:"",label:"区域名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n  "+e._s(-1==t.row.areaName||-2==t.row.areaName?e.title:t.row.areaName)+"\n")]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"comment",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{prop:"picUrlPath",label:"地图"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("img",{staticStyle:{"max-height":"27px",margin:"auto","max-width":"150px","margin-left":"24px"},attrs:{src:""+e.ipPix+t.row.picUrlPath,alt:""}}),e._v(" "),a("div",{staticClass:"fileBtn fileBtnPic"},[a("img",{attrs:{src:e.changePic,alt:""}}),e._v(" "),a("input",{staticStyle:{width:"32px",height:"32px",opacity:"0",position:"absolute",left:"0",top:"0","z-index":"999"},attrs:{id:"setPic"+t.row.id,type:"file",accept:"image/jpg,image/png"},on:{change:function(a){return e.setMap("#setPic"+t.row.id,t.row)}}})])]}}])}),e._v(" "),e.show.goSetLight||e.show.delConfArea?a("el-table-column",{attrs:{label:"操作",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.show.goSetLight?a("button",{staticClass:"detailsBtn",attrs:{type:"text",size:"small"},on:{click:function(a){return e.goLightTimeSet(t.row)}}},[a("i",{staticClass:"el-icon-edit"}),e._v(e._s(-1==t.row.areaName||-2==t.row.areaName?"区域":"配灯"))]):e._e(),e._v(" "),e.show.delConfArea?a("button",{staticClass:"delBtn",attrs:{type:"text",size:"small"},on:{click:function(a){return e.delArea(t.row)}}},[a("i",{staticClass:"el-icon-error"}),e._v("删除")]):e._e()]}}],null,!1,724854019)}):e._e()],1)],1)])])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("p",{staticClass:"header"},[t("span",[this._v("项目设置")])])}]};var i=function(e){a("COM7")},r=a("VU/8")(o.a,n,!1,i,null,null);t.default=r.exports},MIUh:function(e,t,a){"use strict";a.d(t,"d",function(){return i}),a.d(t,"c",function(){return r}),a.d(t,"b",function(){return s}),a.d(t,"a",function(){return c}),a.d(t,"e",function(){return l});var o=a("Rnrl"),n=o.c,i=function(e){return Object(o.b)(n+"lightAllConf/modify/conf_area_pic","post","multipart/form-data",e)},r=function(e){return Object(o.b)(n+"lightAllConf/save/conf_area","post","multipart/form-data",e)},s=function(e){return Object(o.a)(n+"lightAllConf/find/area_list?deviceType="+e+"&time="+100*Math.random())},c=function(e){return Object(o.a)(n+"lightAllConf/find/area_conf?deviceType="+e+"&time="+100*Math.random())},l=function(e,t){return Object(o.a)(n+"lightAllConf/remove/confArea?areaName="+e+"&deviceType="+t+"&time="+100*Math.random())}},koBw:function(e,t,a){"use strict";(function(e){var o=a("mvHQ"),n=a.n(o),i=a("6tXJ"),r=a.n(i),s=a("MIUh");t.a={name:"LightSet",data:function(){return{title:document.title,ipPix:this.ipPix,changePic:r.a,show:{delConfArea:!0,area_conf:!0,shortAddrAll:!0,conf_area:!0,confAreaLightTmp:!0,goSetLight:!0},projectForm:{name:"",remarks:"",file:"",fileName:""},groupOptions:[],tableData:[],changeWebB:"web",tableHeight:0}},methods:{changeWeb:function(e){this.changeWebB="web"==e?"web":"app",this.$root.Bus.$emit("showLoading",!0),this.gettableData()},getgroupOptions:function(){var e=this;Object(s.b)(this.changeWebB).then(function(t){"success"==t.resultCode&&t.data?e.groupOptions=t.data:e.groupOptions=[]})},gettableData:function(){var e=this;Object(s.a)(this.changeWebB).then(function(t){e.$root.Bus.$emit("showLoading",!1),"success"==t.resultCode&&(e.tableData=t.data,0!=t.data.length?e.getgroupOptions():e.groupOptions=[])}).catch(function(){e.$root.Bus.$emit("showLoading",!1)})},setMap:function(t,a){console.log(1);var o=e(t)[0].files[0],n=this;if(console.log(o),void 0!=o){if(o.size/1024>1024)return void this.$message({type:"error",message:"图片大小大于1M!"});var i=new FileReader;i.onload=function(){if("#setMap"==t)n.projectForm.file=o,n.projectForm.fileName=o.name,n.$message({type:"info",message:"图片已上传"});else{console.log(a),console.log(o);var e=new FormData;e.append("zoneId",a.id),e.append("file",o),e.append("deviceType",n.changeWebB),n.$root.Bus.$emit("showLoading",!0),Object(s.d)(e).then(function(e){n.$root.Bus.$emit("showLoading",!1),"success"==e.resultCode&&(n.$message({type:"success",message:"图片切换成功"}),n.gettableData())}).catch(function(){n.$root.Bus.$emit("showLoading",!1)})}},i.readAsDataURL(o)}else this.$message({type:"error",message:"图标不能为空"})},projectFormNameChange:function(){for(var e=0;e<this.tableData.length;e++)this.projectForm.name==this.tableData[e].areaName&&(this.projectForm.name="",this.$message({type:"info",message:"此区域已添加"}))},addArea:function(){var t=this;if(0!=this.groupOptions.length&&""==this.projectForm.name&&-1!=this.projectForm.name&&-2!=this.projectForm.name||""==this.projectForm.file)this.$message({type:"error",message:"请填写完整"});else{console.log(""==this.projectForm.file),0===this.tableData.length&&this.$message({type:"info",message:"第一条默认为总区域信息"}),this.$root.Bus.$emit("showLoading",!0);var a=new FormData;a.append("areaName",this.projectForm.name),a.append("comment",this.projectForm.remarks),a.append("file",this.projectForm.file),a.append("deviceType",this.changeWebB),Object(s.c)(a).then(function(a){t.$root.Bus.$emit("showLoading",!1),"success"==a.resultCode&&(t.$message({type:"success",message:"提交成功"}),t.projectForm={name:"",remarks:"",file:"",fileName:""},e("#setMap").val(""),t.gettableData())}).catch(function(e){console.log(e.response),t.$root.Bus.$emit("showLoading",!1),t.$message({type:"error",message:e.response.data.message.split(",")[0]})})}},goLightTimeSet:function(e){localStorage.setItem("areaMsg",n()(e)),this.$router.push({path:"/LightBox/SetMap",query:{type:"-1"===e.areaName||"-2"===e.areaName?"factory":"light",info:this.changeWebB}})},delArea:function(e){var t=this;this.$confirm("删除此条信息,此次删除会将区域下的灯全部信息删除(会影响其他版块信息)?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){"-1"==e.areaName?t.$confirm("此次删除会将所有灯的全部信息删除，请再次确认?","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){t.$root.Bus.$emit("showLoading",!0),Object(s.e)(e.areaName,t.changeWebB).then(function(e){t.$root.Bus.$emit("showLoading",!1),"success"==e.resultCode&&(t.$message({type:"success",message:"删除成功"}),t.gettableData())}).catch(function(){t.$root.Bus.$emit("showLoading",!1),t.$message({type:"error",message:"网络连接错误"})})}).catch(function(){t.$message({type:"info",message:"已取消设置"})}):(t.$root.Bus.$emit("showLoading",!0),Object(s.e)(e.areaName,t.changeWebB).then(function(e){t.$root.Bus.$emit("showLoading",!1),"success"==e.resultCode&&(t.$message({type:"success",message:"删除成功"}),t.gettableData())}))}).catch(function(){t.$root.Bus.$emit("showLoading",!1),t.$message({type:"info",message:"已取消设置"})})},cellStyle:function(e){e.row,e.column;var t=e.rowIndex,a=(e.columnIndex,{"text-align":"center","font-size":"14px",height:"60px","background-color":"#ffffff",color:"#303030"});return window.innerWidth>1660?t%2!=0&&(a["background-color"]="#f2f4f6"):window.innerWidth>1440?(a.height="52px",t%2!=0&&(a["background-color"]="#f2f4f6")):(a.height="20px",t%2!=0&&(a["background-color"]="#f2f4f6")),a},headerStyle:function(e){e.row,e.column,e.rowIndex,e.columnIndex;var t={"background-color":"#f2f4f6","font-size":"16px",color:"#101010","text-align":"center",height:"60px"};return window.innerWidth>1440?(t.height="52px",t["font-size"]="14px"):(t.height="20px",t["font-size"]="14px"),t}},mounted:function(){var t=this;this.$nextTick(function(){t.tableHeight=e(".projextSet").height()-242}),window.addEventListener("resize",function(){t.tableHeight=e(".projextSet").height()-242}),this.changeWebB="app"==this.$route.query.info?"app":"web",this.gettableData()}}}).call(t,a("7t+N"))}});